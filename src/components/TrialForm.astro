---
import { getTranslation, type Language } from "../lib/i18n";
// Trial Application Form Component
---

<div id="trial" class="bg-white rounded-2xl shadow-xl p-8 max-w-2xl mx-auto">
  <div class="text-center mb-8">
    <h2 class="text-3xl font-bold text-gray-900 mb-4" id="trial-title">
      無料トライアルについて
    </h2>
    <p class="text-lg text-gray-600 mb-2">
      <span class="text-red-500 font-bold" id="trial-limited">50名限定!</span>
      <span id="trial-description">あなたの名刺を1枚無料で作成します。</span>
    </p>
    <p class="text-sm text-gray-500" id="trial-sub-description">
      デザイン変更無制限、AI名刺撮影・VCard変換利用可
    </p>
  </div>

  <!-- Contact Form (Temporary) -->
  <div class="bg-gray-50 rounded-lg p-6">
    <div class="text-center">
      <h3
        class="text-xl font-semibold text-gray-800 mb-4"
        id="contact-form-title"
      >
        お問い合わせフォーム
      </h3>
      <p class="text-gray-600 mb-6" id="contact-form-description">
        無料トライアルについてご質問がございましたら、下記のボタンからお問い合わせください。
      </p>
      <a
        href="https://cor-jp.com/contact/"
        target="_blank"
        rel="noopener noreferrer"
        class="inline-flex items-center bg-blue-500 hover:bg-blue-600 text-white px-8 py-4 rounded-full text-lg font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl"
        id="contact-form-button"
      >
        <svg
          class="w-5 h-5 mr-2"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
          ></path>
        </svg>
        <span id="contact-form-button-text">お問い合わせフォームへ</span>
      </a>
    </div>
  </div>
  <!-- Terms and Conditions -->
  <div class="mt-6 text-center">
    <p class="text-xs text-gray-500" id="terms-text">
      <span id="terms-text-start">申し込みにより、</span><a
        href="/terms"
        class="text-blue-600 hover:underline"
        id="terms-link"
        data-link="terms">利用規約</a
      ><span id="terms-and">および</span><a
        href="/privacy"
        class="text-blue-600 hover:underline"
        id="privacy-link"
        data-link="privacy">プライバシーポリシー</a
      ><span id="terms-text-end">に同意したものとみなされます。</span>
    </p>
  </div>
</div>

<script>
  // Form validation and submission handling
  document.addEventListener("DOMContentLoaded", function () {
    // Get current language from URL or localStorage
    const urlParams = new URLSearchParams(window.location.search);
    const urlLang = urlParams.get("lang");
    const storedLang = localStorage.getItem("preferred-language");
    const currentLang = urlLang || storedLang || "ja";

    // Update trial form content based on language
    updateTrialFormContent(currentLang);

    // Add smooth scrolling for anchor links
    const trialLinks = document.querySelectorAll('a[href="#trial"]');
    trialLinks.forEach((link) => {
      link.addEventListener("click", function (e) {
        e.preventDefault();
        const trialSection = document.getElementById("trial");
        if (trialSection) {
          trialSection.scrollIntoView({
            behavior: "smooth",
            block: "start",
          });
        }
      });
    });

    // Track contact form interactions for analytics
    const contactButton = document.querySelector(
      'a[href*="cor-jp.com/contact"]',
    );
    if (contactButton) {
      contactButton.addEventListener("click", function () {
        // Track contact form click event
        if (typeof window !== "undefined" && (window as any).gtag) {
          (window as any).gtag("event", "contact_form_click", {
            event_category: "trial_form",
            event_label: "contact_form_clicked",
          });
        }
      });
    }
  });

  function updateTrialFormContent(lang) {
    const translations = {
      ja: {
        title: "無料トライアルについて",
        limited: "50名限定!",
        description: "あなたの名刺を1枚無料で作成します。",
        subDescription: "デザイン変更無制限、AI名刺撮影・VCard変換利用可",
        contactFormTitle: "お問い合わせフォーム",
        contactFormDescription:
          "無料トライアルについてご質問がございましたら、下記のボタンからお問い合わせください。",
        contactFormButton: "お問い合わせフォームへ",
        termsTextStart: "申し込みにより、",
        termsLink: "利用規約",
        termsAnd: "および",
        privacyLink: "プライバシーポリシー",
        termsTextEnd: "に同意したものとみなされます。",
      },
      en: {
        title: "About Free Trial",
        limited: "Limited to 50!",
        description: "We'll create one business card for you for free.",
        subDescription:
          "Unlimited design changes, AI business card scanning & VCard conversion available",
        contactFormTitle: "Contact Form",
        contactFormDescription:
          "If you have any questions about the free trial, please contact us through the button below.",
        contactFormButton: "Go to Contact Form",
        termsTextStart: "By applying, you agree to our ",
        termsLink: "Terms of Service",
        termsAnd: " and ",
        privacyLink: "Privacy Policy",
        termsTextEnd: ".",
      },
      zh: {
        title: "关于免费试用",
        limited: "限50名！",
        description: "我们将为您免费制作一张名片。",
        subDescription: "无限设计更改，AI名片扫描和VCard转换可用",
        contactFormTitle: "联系表单",
        contactFormDescription:
          "如果您对免费试用有任何疑问，请通过下面的按钮联系我们。",
        contactFormButton: "前往联系表单",
        termsTextStart: "申请即表示您同意我们的",
        termsLink: "服务条款",
        termsAnd: "和",
        privacyLink: "隐私政策",
        termsTextEnd: "。",
      },
      es: {
        title: "Acerca de la Prueba Gratuita",
        limited: "¡Limitado a 50!",
        description: "Crearemos una tarjeta de presentación gratis para ti.",
        subDescription:
          "Cambios de diseño ilimitados, escaneo de tarjeta con IA y conversión VCard disponibles",
        contactFormTitle: "Formulario de Contacto",
        contactFormDescription:
          "Si tienes alguna pregunta sobre la prueba gratuita, contáctanos a través del botón de abajo.",
        contactFormButton: "Ir al Formulario de Contacto",
        termsTextStart: "Al solicitar, aceptas nuestros ",
        termsLink: "Términos de Servicio",
        termsAnd: " y ",
        privacyLink: "Política de Privacidad",
        termsTextEnd: ".",
      },
    };

    const t = translations[lang] || translations["ja"];

    // Update title
    const titleElement = document.getElementById("trial-title");
    if (titleElement) {
      titleElement.textContent = t.title;
    }

    // Update limited text
    const limitedElement = document.getElementById("trial-limited");
    if (limitedElement) {
      limitedElement.textContent = t.limited;
    }

    // Update description
    const descElement = document.getElementById("trial-description");
    if (descElement) {
      descElement.textContent = t.description;
    }

    // Update sub description
    const subDescElement = document.getElementById("trial-sub-description");
    if (subDescElement) {
      subDescElement.textContent = t.subDescription;
    }

    // Update contact form title
    const contactTitleElement = document.getElementById("contact-form-title");
    if (contactTitleElement) {
      contactTitleElement.textContent = t.contactFormTitle;
    }

    // Update contact form description
    const contactDescElement = document.getElementById(
      "contact-form-description",
    );
    if (contactDescElement) {
      contactDescElement.textContent = t.contactFormDescription;
    }

    // Update contact form button text
    const contactButtonTextElement = document.getElementById(
      "contact-form-button-text",
    );
    if (contactButtonTextElement) {
      contactButtonTextElement.textContent = t.contactFormButton;
    }

    // Update terms text
    const termsTextStartElement = document.getElementById("terms-text-start");
    if (termsTextStartElement) {
      termsTextStartElement.textContent = t.termsTextStart;
    }

    const termsLinkElement = document.getElementById("terms-link");
    if (termsLinkElement) {
      termsLinkElement.textContent = t.termsLink;
      // Update href with language parameter
      const termsHref = lang === "ja" ? "/terms" : `/terms?lang=${lang}`;
      termsLinkElement.setAttribute("href", termsHref);
    }

    const termsAndElement = document.getElementById("terms-and");
    if (termsAndElement) {
      termsAndElement.textContent = t.termsAnd;
    }

    const privacyLinkElement = document.getElementById("privacy-link");
    if (privacyLinkElement) {
      privacyLinkElement.textContent = t.privacyLink;
      // Update href with language parameter
      const privacyHref = lang === "ja" ? "/privacy" : `/privacy?lang=${lang}`;
      privacyLinkElement.setAttribute("href", privacyHref);
    }

    const termsTextEndElement = document.getElementById("terms-text-end");
    if (termsTextEndElement) {
      termsTextEndElement.textContent = t.termsTextEnd;
    }
  }
</script>
