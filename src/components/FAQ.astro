---
import { translations, type Language } from '../lib/i18n';

interface Props {
  lang: Language;
}

const { lang = 'ja' } = Astro.props;
const t = translations[lang].faq;
---

<section id="faq" class="py-20 bg-white">
  <div class="container mx-auto px-4">
    <div class="text-center mb-16">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
        {t.title}
      </h2>
      <p class="text-xl text-gray-600">
        {t.subtitle}
      </p>
    </div>

    <div class="max-w-4xl mx-auto">
      <div class="space-y-4">
        <!-- FAQ Item 1 -->
        <details class="group bg-gray-50 rounded-lg">
          <summary class="flex justify-between items-center p-6 cursor-pointer hover:bg-gray-100 transition-colors">
            <h3 class="text-lg font-semibold text-gray-900">
              {t.items[0].question}
            </h3>
            <svg class="w-5 h-5 text-gray-500 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </summary>
          <div class="px-6 pb-6">
            <p class="text-gray-700 leading-relaxed">
              {t.items[0].answer.split('\n').map(line => (
                <>
                  {line}
                  <br />
                </>
              ))}
            </p>
          </div>
        </details>

        <!-- FAQ Item 2 -->
        <details class="group bg-gray-50 rounded-lg">
          <summary class="flex justify-between items-center p-6 cursor-pointer hover:bg-gray-100 transition-colors">
            <h3 class="text-lg font-semibold text-gray-900">
              {t.items[1].question}
            </h3>
            <svg class="w-5 h-5 text-gray-500 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </summary>
          <div class="px-6 pb-6">
            <p class="text-gray-700 leading-relaxed">
              {t.items[1].answer.split('\n').map(line => (
                <>
                  {line}
                  <br />
                </>
              ))}
            </p>
          </div>
        </details>

        <!-- FAQ Item 3 -->
        <details class="group bg-gray-50 rounded-lg">
          <summary class="flex justify-between items-center p-6 cursor-pointer hover:bg-gray-100 transition-colors">
            <h3 class="text-lg font-semibold text-gray-900">
              {t.items[2].question}
            </h3>
            <svg class="w-5 h-5 text-gray-500 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </summary>
          <div class="px-6 pb-6">
            <p class="text-gray-700 leading-relaxed">
              {t.items[2].answer.split('\n').map(line => (
                <>
                  {line}
                  <br />
                </>
              ))}
            </p>
          </div>
        </details>

        <!-- FAQ Item 4 -->
        <details class="group bg-gray-50 rounded-lg">
          <summary class="flex justify-between items-center p-6 cursor-pointer hover:bg-gray-100 transition-colors">
            <h3 class="text-lg font-semibold text-gray-900">
              {t.items[3].question}
            </h3>
            <svg class="w-5 h-5 text-gray-500 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </summary>
          <div class="px-6 pb-6">
            <p class="text-gray-700 leading-relaxed">
              {t.items[3].answer.split('\n').map(line => (
                <>
                  {line}
                  <br />
                </>
              ))}
            </p>
          </div>
        </details>

        <!-- FAQ Item 5 -->
        <details class="group bg-gray-50 rounded-lg">
          <summary class="flex justify-between items-center p-6 cursor-pointer hover:bg-gray-100 transition-colors">
            <h3 class="text-lg font-semibold text-gray-900">
              {t.items[4].question}
            </h3>
            <svg class="w-5 h-5 text-gray-500 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </summary>
          <div class="px-6 pb-6">
            <p class="text-gray-700 leading-relaxed">
              {t.items[4].answer.split('\n').map(line => (
                <>
                  {line}
                  <br />
                </>
              ))}
            </p>
          </div>
        </details>
      </div>
    </div>

    <!-- Additional Help -->
    <div class="mt-12 text-center">
      <div class="bg-blue-50 rounded-xl p-8 max-w-2xl mx-auto">
        <h3 class="text-xl font-semibold text-gray-900 mb-4">
          {t.additionalHelp.title}
        </h3>
        <p class="text-gray-600 mb-6">{t.additionalHelp.description}</p>
        <a
          href="https://cor-jp.com/contact/"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-full font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl"
        >
          <svg
            class="w-5 h-5 mr-2"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
            ></path>
          </svg>
          {t.additionalHelp.button}
        </a>
      </div>
    </div>
  </div>
</section>

<script>
  // Client-side language switching for FAQ
  document.addEventListener("DOMContentLoaded", function () {
    const urlParams = new URLSearchParams(window.location.search);
    const urlLang = urlParams.get('lang');
    const storedLang = localStorage.getItem('preferred-language');
    const currentLang = urlLang || storedLang || 'ja';
    
    updateFAQContent(currentLang);
  });

  function updateFAQContent(lang) {
    const translations = {
      ja: {
        title: "よくある質問",
        subtitle: "お客様からよくいただくご質問にお答えします",
        items: [
          {
            question: "どのスマホでもNFCは使えますか？",
            answer: "95%のスマホで互換性があります。iPhone 7以降、Android NFC対応機種でご利用いただけます。\n具体的な対応機種については、各スマホメーカーの公式サイトをご確認ください。"
          },
          {
            question: "名刺読み取りの精度は？",
            answer: "AI名刺撮影・VCard変換の精度は95%です。継続的な改善により、さらなる精度向上を目指しています。\n認識に失敗した場合は、手動での修正も可能です。"
          },
          {
            question: "デザイン変更は自分でできるのですか？",
            answer: "管理画面から無制限でデザイン変更が可能です。\nライトカラー（白・ライトブルー・ベージュ）の3種類から選択でき、テキストや連絡先情報も簡単に更新できます。"
          },
          {
            question: "多言語対応の使い方を教えてください",
            answer: "4言語（日本語・英語・中国語・スペイン語）にご自身で切り替えることができます。\nプロフィール画面で表示言語を選択できるため、相手のスマートフォンの言語設定に関わらず、好きな言語でご利用いただけます。"
          },
          {
            question: "オフラインでも使えますか？",
            answer: "現在はオンライン環境でのご利用を推奨しています。\nオフライン機能は今後検討中です。アプリ不要のメリットを活かし、オンライン環境での安定したサービス提供を優先しています。"
          }
        ],
        additionalHelp: {
          title: "その他のご質問はお気軽にお問い合わせください",
          description: "専門スタッフが丁寧にお答えいたします",
          button: "お問い合わせ"
        }
      },
      en: {
        title: "Frequently Asked Questions",
        subtitle: "We answer frequently asked questions from our customers",
        items: [
          {
            question: "Can NFC be used on any smartphone?",
            answer: "Compatible with 95% of smartphones. Available on iPhone 7 and later, and Android NFC-compatible models.\nFor specific compatible models, please check the official website of each smartphone manufacturer."
          },
          {
            question: "What is the accuracy of business card reading?",
            answer: "AI business card shooting and VCard conversion accuracy is 95%. We aim for further accuracy improvement through continuous improvement.\nIf recognition fails, manual correction is also possible."
          },
          {
            question: "Can I change the design myself?",
            answer: "Unlimited design changes are possible from the management screen.\nYou can choose from 3 types of light colors (white, light blue, beige), and text and contact information can be easily updated."
          },
          {
            question: "Please tell me how to use multilingual support",
            answer: "You can switch to 4 languages (Japanese, English, Chinese, Spanish) yourself.\nYou can select the display language on the profile screen, so you can use it in your preferred language regardless of the other party's smartphone language settings."
          },
          {
            question: "Can it be used offline?",
            answer: "Currently, we recommend using it in an online environment.\nOffline functionality is under consideration for the future. We prioritize stable service provision in an online environment, taking advantage of the no-app benefit."
          }
        ],
        additionalHelp: {
          title: "Please feel free to contact us for other questions",
          description: "Our professional staff will answer you carefully",
          button: "Contact Us"
        }
      },
      zh: {
        title: "常见问题",
        subtitle: "我们回答客户经常提出的问题",
        items: [
          {
            question: "任何智能手机都可以使用NFC吗？",
            answer: "与95%的智能手机兼容。可在iPhone 7及以后版本、Android NFC兼容机型上使用。\n关于具体兼容机型，请查看各智能手机制造商的官方网站。"
          },
          {
            question: "名片读取的精度如何？",
            answer: "AI名片拍摄和VCard转换精度为95%。通过持续改进，我们致力于进一步提高精度。\n如果识别失败，也可以手动修正。"
          },
          {
            question: "可以自己更改设计吗？",
            answer: "可以从管理画面无限制地更改设计。\n可以选择3种浅色（白色、浅蓝色、米色），文本和联系信息也可以轻松更新。"
          },
          {
            question: "请告诉我多语言支持的使用方法",
            answer: "可以自己切换到4种语言（日语、英语、中文、西班牙语）。\n可以在个人资料画面选择显示语言，因此无论对方的智能手机语言设置如何，都可以用自己喜欢的语言使用。"
          },
          {
            question: "离线时也可以使用吗？",
            answer: "目前建议在在线环境下使用。\n离线功能正在考虑中。我们优先在在线环境下提供稳定服务，发挥无需应用的优势。"
          }
        ],
        additionalHelp: {
          title: "如有其他问题请随时联系我们",
          description: "专业工作人员会仔细回答您的问题",
          button: "联系我们"
        }
      },
      es: {
        title: "Preguntas Frecuentes",
        subtitle: "Respondemos preguntas frecuentes de nuestros clientes",
        items: [
          {
            question: "¿Se puede usar NFC en cualquier smartphone?",
            answer: "Compatible con el 95% de los smartphones. Disponible en iPhone 7 y posteriores, y modelos Android compatibles con NFC.\nPara modelos específicos compatibles, consulte el sitio web oficial de cada fabricante de smartphones."
          },
          {
            question: "¿Cuál es la precisión de la lectura de tarjetas de presentación?",
            answer: "La precisión del disparo de tarjetas de presentación con IA y la conversión VCard es del 95%. Buscamos una mayor precisión a través de mejoras continuas.\nSi el reconocimiento falla, también es posible la corrección manual."
          },
          {
            question: "¿Puedo cambiar el diseño yo mismo?",
            answer: "Los cambios de diseño ilimitados son posibles desde la pantalla de administración.\nPuedes elegir entre 3 tipos de colores claros (blanco, azul claro, beige), y el texto y la información de contacto se pueden actualizar fácilmente."
          },
          {
            question: "Por favor, dime cómo usar el soporte multilingüe",
            answer: "Puedes cambiar a 4 idiomas (japonés, inglés, chino, español) tú mismo.\nPuedes seleccionar el idioma de visualización en la pantalla de perfil, por lo que puedes usarlo en tu idioma preferido independientemente de la configuración de idioma del smartphone de la otra parte."
          },
          {
            question: "¿Se puede usar sin conexión?",
            answer: "Actualmente recomendamos usarlo en un entorno en línea.\nLa funcionalidad sin conexión está bajo consideración para el futuro. Priorizamos la provisión de servicios estables en un entorno en línea, aprovechando el beneficio de no requerir aplicación."
          }
        ],
        additionalHelp: {
          title: "Por favor, no dudes en contactarnos para otras preguntas",
          description: "Nuestro personal profesional te responderá cuidadosamente",
          button: "Contáctanos"
        }
      }
    };

    const t = translations[lang] || translations['ja'];

    // Update title and subtitle
    const titleElement = document.querySelector('#faq h2');
    if (titleElement) {
      titleElement.textContent = t.title;
    }
    const subtitleElement = document.querySelector('#faq p');
    if (subtitleElement) {
      subtitleElement.textContent = t.subtitle;
    }

    // Update FAQ items
    const faqItems = document.querySelectorAll('#faq details');
    faqItems.forEach((item, index) => {
      if (t.items[index]) {
        const questionElement = item.querySelector('h3');
        if (questionElement) {
          questionElement.textContent = t.items[index].question;
        }
        const answerElement = item.querySelector('p');
        if (answerElement) {
          answerElement.innerHTML = t.items[index].answer.split('\n').join('<br>');
        }
      }
    });

    // Update additional help section
    const helpTitleElement = document.querySelector('#faq .mt-12 h3');
    if (helpTitleElement) {
      helpTitleElement.textContent = t.additionalHelp.title;
    }
    const helpDescElement = document.querySelector('#faq .mt-12 p');
    if (helpDescElement) {
      helpDescElement.textContent = t.additionalHelp.description;
    }
    const helpButtonElement = document.querySelector('#faq .mt-12 a');
    if (helpButtonElement) {
      helpButtonElement.textContent = t.additionalHelp.button;
    }
  }
</script>
